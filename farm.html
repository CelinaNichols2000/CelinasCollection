<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Celinaâ€™s Enchanted Farm</title>
  <link rel="stylesheet" href="farm.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Farm Section -->
  <section class="farm-section">
    <div class="farm-overlay">
      <h1 class="farm-title">Celinas Enchanted Farm</h1>
      <p class="farm-text">Of course the tricky foxo Celina doesnt just collect toys and clothes there~ She has a little farm of her own, just to show of her lifestock and get some fresh ingredients for breakfast~</p>

      <div class="farm-actions">
      <!-- <button id="startFarm" class="farm-btn">ðŸŒ¾ Start</button>
        <button id="randomEncounter" class="farm-btn">ðŸŽ² Zufall</button>
        <button id="resetFarm" class="farm-btn">ðŸ”„ Reset</button>--> 
      </div>
    </div>
  </section>

  <!-- Locations -->
  <section class="farm-location-section">
    <h2 class="farm-subtitle">Orte</h2>
    <div class="farm-location-grid">
      <div id="locationsGrid" class="farm-location-grid"></div>
    </div>
  </section>

  <!-- Encounter Modal -->
  <div id="farmModal" class="farm-modal">
    <div class="farm-modal-content">
      <button class="farm-close">&times;</button>
      <div id="modalStageContainer"></div>
    </div>
  </div>

  <script src="farm.js" defer></script>
  <script>
    // GLOBAL TRANSFORMATION STATE CHECKER
    (function() {
        const state = JSON.parse(localStorage.getItem('farmState') || '{}');
        if (state.trappedUntil && state.trappedUntil > Date.now()) {
            // IMMEDIATELY redirect to transformation page
            const formMap = {
                'foxfire_mistress': 'farm/States/forest-panties.html',
                'living_grove': 'farm/States/forest-artifact.html', 
                'hungry_moss': 'farm/States/forest-frog.html'
            };
            const transformPage = formMap[state.currentForm] || 'generic-trapped.html';
            window.location.href = transformPage;
        }
    })();
</script>
</body>
</html>
